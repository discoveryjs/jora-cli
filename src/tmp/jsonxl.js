var le=new Uint8Array([0,0,74,83,79,78,88,76]),re=9,ge=255,ye=65535,Re=16777215,se=268435455,Ue=1073741823;var Q=4294967295,ke=-127,Oe=127,me=-32767,Me=32767,Ce=-8388607,Se=8388607,Ye=-2147483647,Ve=2147483647,Be=127,De=16383,Pe=2097151,X=0,Le=1,V=2,w=4,Y=8,b=16,F=32,q=64,g=128,y=0,U=1,H=2,K=3,z=4,W=5,J=6;var B=8,D=9,P=10,L=11,G=12,Ge=31,Z=224,he=7936,R=0,E=1,m=2,M=3,C=4,S=5,j=6,v=7,ne=8,je=0,$=16,ie=32,ve=~b,Xe=V|F|q,k=new Uint8Array(256).map((t,e)=>{for(let r=0;r<8;r++)t+=e>>r&1;return t});var ze=65536,ue=new Uint32Array(16),Ie=ue.subarray(0,8),Fe=ue.subarray(8,16);function de(t){return Math.fround(t)===t?W:J}function xe(t){return t<0?t<me?t<Ce?t<Ye?G:L:P:t<ke?D:B:t>Me?t>Se?t>Ve?G:L:P:t>Oe?D:B}function Qe(t){return t>ye?t>Re?t>Q?z:K:H:t>ge?U:y}function Te(t){return Number.isInteger(t)?t<0?xe(t):Qe(t):de(t)}function ft(t){return Number.isInteger(t)?xe(t):de(t)}function qe(t,e){let r=Math.max(Math.abs(t),Math.abs(e)),o=t<0?1:0;return Math.max(32-Math.clz32(r)+o,1)}function at(t,e,r,o){switch(o){case y:e[R]+=1,e[m]+=r>127?2:1,e[C]+=r>7?1:0;break;case U:e[R]+=2,e[m]+=r>16383?3:2,e[C]+=r>1023?2:1;break;case H:e[R]+=3,e[m]+=r>2097151?4:3,e[C]+=r>131071?3:2;break;case K:e[R]+=4,e[m]+=r>268435455?5:4,e[C]+=r>16777215?4:3;break;case z:{let h=t.vlqBytesNeeded(r);e[R]+=h,e[m]+=h,e[C]+=t.vlqBytesNeeded((r-(r&7))/8);break}}}function lt(t,e,r,o){switch(r<0&&(r=-r),o){case B:{e[E]+=1,e[M]+=r>63?2:1,e[S]+=r>3?1:0;break}case D:{e[E]+=2,e[M]+=r>8191?3:2,e[S]+=r>511?2:1;break}case P:{e[E]+=3,e[M]+=r>1048575?4:3,e[S]+=r>65535?3:2;break}case L:{e[E]+=4,e[M]+=r>134217727?5:4,e[S]+=r>8388607?4:3;break}case G:{let h=2*r,s=t.vlqBytesNeeded(h);e[E]+=s,e[M]+=s,e[S]+=t.vlqBytesNeeded((h-(h&7))/8);break}}}function He(t,e,r){let o=xe(r);if(lt(t,e,r,o),r>=0){let h=Qe(r);return at(t,e,r,h),1<<o|1<<h}return 1<<o|ze}function We(t,e,r,o){let h=r&ze,s=h?E:R,f=h?(r>>8|r&Z)&255:r&(Ge|Z),i=k[f],c=e[s]+(i>1?Math.ceil(t*(i<=2?1:i<=4?2:3)/8):0)+(o?2:0);return{encoding:f<<8|s,minBytes:c}}function Ke(t,e,r,o,h,s){let f=s<=16?Math.ceil(t*s/8)+(o?2:0):1/0,{encoding:i,minBytes:c}=We(t,e,r,o);if((i&15)===E){let a=e[M]+(o?1:0),l=e[S]+Math.ceil(t/2)+(o?1:0);f<c&&(i=s<<8|v,c=f),a<c&&(i=M,c=a),l<c&&(i=S,c=l)}else{let a=e[m]+(o?1:0),l=e[C]+Math.ceil(t/2)+(o?1:0);f<c&&(i=s<<8|j,c=f),a<c&&(i=m,c=a),l<c&&(i=C,c=l)}return{encoding:i|h,minBytes:c}}function ht(t,e,r=!0,o=0,h=e.length){let s=h-o,f=0,i=!1,c=e[o],n=e[o];ue.fill(0);for(let x=o;x<h;x++){let p=e[x];Number.isInteger(p)?f|=He(t,Ie,p):(f|=1<<de(p),i=!0),p<c&&(c=p),p>n&&(n=p)}if(i||s<2)return We(s,Ie,f,r);let a=e[o+1]-e[o],l=a,_=a,u=0;for(let x=o;x<h;x++){let p=e[x];if(x!==o){let A=p-e[x-1];u|=He(t,Fe,A),a!==A&&(a=!1),A>l&&(l=A),A<_&&(_=A)}}let{encoding:I,minBytes:d}=Ke(s,Ie,f,r,je,qe(c,n)),T=Ke(s-1,Fe,u,r,$,qe(_,l)),N=T.minBytes+t.intVarBytesNeeded(e[o]);if(N<d&&(I=T.encoding,d=N),s>2&&a!==!1){let x=t.intVarBytesNeeded(e[o])+t.intVarBytesNeeded(a)+(r?1:0);x<d&&(I=ne,d=x)}return{encoding:I,minBytes:d}}function pe(t,e,r=!0){let{encoding:o}=ht(t,e,r);return o}function _t(t,e){switch(e&15){case R:case E:case j:case v:t.writeNumber(e,U);break;default:t.writeNumber(e,y)}}function O(t,e,r){if(r||t.writeVlq(e.length),e.length>0){let o=pe(t,e,!0);_t(t,o),Ae(t,e,o)}}function Ae(t,e,r){let o=r&15,h=r&48,s=e;switch(h){case $:{t.writeIntVar(s[0]),s=Array.from({length:e.length-1},(f,i)=>e[i+1]-e[i]);break}case ie:{let f=s[0];for(let i=1;i<s.length;i++)s[i]<f&&(f=s[i]);t.writeIntVar(f),s=Array.from(e,i=>i-f);break}}switch(o){case m:{for(let f=0;f<s.length;f++)t.writeVlq(s[f]);break}case M:{for(let f=0;f<s.length;f++)t.writeIntVar(s[f]);break}case C:{for(let f=0;f<s.length;f+=2)t.writeNumber((s[f]>7?8:0)|s[f]&7|(s[f+1]>7?128:0)|(s[f+1]&7)<<4,y);for(let f=0;f<s.length;f++)s[f]>7&&t.writeVlq((s[f]-(s[f]&7))/8);break}case S:{for(let f=0;f<s.length;f+=2){let i=s[f],c=Math.abs(i),n=s[f+1]||0,a=Math.abs(n);t.writeNumber((c>3?8:0)|c&3|(i<0?4:0)|(a>3?128:0)|(a&3|(n<0?4:0))<<4,y)}for(let f=0;f<s.length;f++){let i=s[f]>=0?s[f]:-s[f];i>3&&t.writeVlq((i-(i&3))/4)}break}case j:{let f=r>>8,i=0,c=0;for(let n=0;n<s.length;n++)c|=s[n]<<i,i+=f,i>=16&&(t.writeNumber(c,U),i-=16,c>>=16);i>8?t.writeNumber(c,U):i>0&&t.writeNumber(c,y);break}case v:{let f=r>>8,i=0,c=0;for(let n=0;n<s.length;n++){let a=s[n];c|=(a<0?-a<<1|1:a<<1)<<i,i+=f,i>=16&&(t.writeNumber(c,U),i-=16,c>>=16)}i>8?t.writeNumber(c,U):i>0&&t.writeNumber(c,y);break}case ne:{t.writeIntVar(s[0]),t.writeIntVar(s[1]-s[0]);break}case R:case E:{let f=o===E,i=r>>8,c=f?r&he|i&Z:i;if(k[i]>1){let a=f?s.map(ft):s.map(Te);t.writeTypeIndex(a,c,!1);for(let l=0;l<s.length;l++)t.writeNumber(s[l],a[l])}else{let a=31-Math.clz32(c);for(let l=0;l<s.length;l++)t.writeNumber(s[l],a)}break}default:throw new Error("Unknown numeric array encoding method:",o)}}function Nt(t,e){let r=Math.min(t.length,e.length);if(r>=3){let o=0;for(;o<r&&t[o]===e[o];o++);if(o>=3)return o}return 0}function It(t,e,r){let o=Math.min(t.length,e.length-r);if(o>=3){let h=0;for(;h<o&&t[t.length-1-h]===e[e.length-1-h];h++);if(h>=3)return-h}return 0}function Je(t,e,r,o,h,s,f){let i="",c="";t.sort((n,a)=>e[n]<e[a]?-1:1);for(let n=0;n<t.length;n++){let a=f++,l=t[n],_=e[l],u=Nt(c,_),I=It(c,_,u)||_.length,d=u>0,T=I<0,N=d||T?_.slice(u,I):_;s[l]=a,r[a]=N.length<<2|d<<1|T<<0,i+=N,c=_,d&&o.push(u),T&&h.push(-I)}return i}function Ze(t,e){let r=new Uint32Array(t.length),o=[],h=[],s=new Uint32Array(t.length),f=new Uint32Array(t.length),i=new Set,c="",n=0;for(let l=0;l<e.length;l++){let _=e[l];++s[_]===2&&i.add(_)}let a=new Uint32Array(i).sort((l,_)=>s[_]-s[l]);for(let l of[[0,127],[127,16383]])if(a.length>n){let _=a.subarray(l[0],l[1]);c+=Je(_,t,r,o,h,f,n),n+=_.length;for(let u=0;u<_.length;u++)s[_[u]]=0}for(let l=0,_=0;l<s.length;l++)s[l]!==0&&(s[_++]=l);c+=Je(s.subarray(0,s.length-n),t,r,o,h,f,n);for(let l=0;l<e.length;l++)e[l]=f[e[l]];return{strings:c,stringDefs:r,stringSlicesStart:o,stringSlicesEnd:h,stringRefs:e}}var ut=new TextEncoder;function be(t=65536){let e=()=>{s=[],r()},r=()=>{f=new Uint8Array(t),i=new DataView(f.buffer),c=0},o=()=>{s.push(f.subarray(0,c)),f=i=null},h=n=>{c+n>f.length&&(o(),r())},s=null,f=null,i=null,c=0;if(t<8)throw new Error("Chunk size can't be less than 8 bytes");return e(),{ensureCapacity:h,reset:e,emit(){o();let n=Buffer.concat(s);return s=null,n},get written(){return s!==null?s.reduce((n,a)=>n+a.byteLength,0)+c:0},get state(){let n=this.written;try{return f.slice(this.x,n)}finally{this.x=n}},get stateHex(){return[...this.state].map(n=>n.toString(16).padStart(2,0)).join(" ")},writeBytes(n){let a=0;for(;a<n.byteLength;){let l=n.byteLength-c,_=n.subarray(a,a+=l);n.set(_,c),c+=_.byteLength,a<n.byteLength&&(o(),r())}},writeString(n){let a=0;for(;a<n.length;){let{read:l,written:_}=ut.encodeInto(a>0?n.slice(a):n,c>0?f.subarray(c):f);a+=l,c+=_,a<n.length&&(o(),r())}},writeUint8(n){h(1),i.setUint8(c,n),c+=1},writeInt8(n){h(1),i.setInt8(c,n),c+=1},writeUint16(n){h(2),i.setUint16(c,n,!0),c+=2},writeInt16(n){h(2),i.setInt16(c,n,!0),c+=2},writeUint24(n){h(3),i.setUint16(c,n,!0),i.setUint8(c+2,n>>16),c+=3},writeInt24(n){h(3),i.setInt16(c,n,!0),i.setInt8(c+2,n>>16),c+=3},writeUint32(n){h(4),i.setUint32(c,n,!0),c+=4},writeInt32(n){h(4),i.setInt32(c,n,!0),c+=4},writeUint64(n){h(8),i.setBigUint64(c,BigInt(n),!0),c+=8},writeFloat32(n){h(4),i.setFloat32(c,n,!0),c+=4},writeFloat64(n){h(8),i.setFloat64(c,n,!0),c+=8}}}var et=new Uint8Array(33);for(let t=0;t<33;t++)et[32-t]=Math.ceil(t/7)||1;function $e(t,e){let r=new Uint32Array(e.length),o=new Uint32Array(e.length).map((s,f)=>f),h=e.slice();for(let s=0;s<t.length;s++)r[t[s]]++;o.sort((s,f)=>r[f]-r[s]||s-f);for(let s=0;s<o.length;s++)r[o[s]]=s,e[s]=h[o[s]];for(let s=0;s<t.length;s++)t[s]=r[t[s]]}var oe=class{constructor(e){this.backend=be(e),this.objectKeys=new Map,this.objectEntryDefs=[],this.arrayLengths=[],this.arrayHeaders=new Map,this.arrayHeaderRefs=[],this.strings=new Map,this.stringRefs=[]}emit(){let e=new Uint8Array(12),r=new DataView(e.buffer);e.set(le),r.setUint16(8,re,!0);let o=this.backend.emit();for(let l of this.objectKeys.keys())this.writeString(l);let{strings:h,stringDefs:s,stringSlicesStart:f,stringSlicesEnd:i,stringRefs:c}=Ze([...this.strings.keys()],this.stringRefs);this.backend.reset(),this.writeVlq(Buffer.byteLength(h)),this.backend.writeString(h),O(this,s),O(this,f),O(this,i),O(this,c),O(this,this.arrayLengths);let n=[...this.arrayHeaders.keys()];$e(this.arrayHeaderRefs,n),O(this,n),O(this,this.arrayHeaderRefs),this.writeVlq(this.objectEntryDefs.length),this.writeVlq(this.objectKeys.size);for(let l of this.objectEntryDefs){let _=[0,...l.keys()],u=l.refs;$e(u,_),O(this,_),O(this,u)}let a=this.backend.emit();return Buffer.concat([e,a,o])}writeString(e){let r=this.strings.get(e);r===void 0&&this.strings.set(e,r=this.strings.size),this.stringRefs.push(r)}writeObjectEntryKey(e,r,o){let h=this.objectKeys.get(r);h===void 0&&this.objectKeys.set(r,h=this.objectKeys.size);let s=e>=this.objectEntryDefs.length?this.objectEntryDefs[e]=Object.assign(new Map,{refs:[]}):this.objectEntryDefs[e],f=h<<8|o,i=this.objectEntryDefs[e].get(f);i===void 0&&s.set(f,i=s.size+1),s.refs.push(i)}writeObjectEntriesEnd(e){e>=this.objectEntryDefs.length?this.objectEntryDefs[e]=Object.assign(new Map,{refs:[0]}):this.objectEntryDefs[e].refs.push(0)}writeTypeIndex(e,r,o){let h=0,s=0,f=0;for(;r>0;)r&1&&(h|=f++<<(s<<2)),s++,r>>=1;let i=32-Math.clz32(f-1),c=0,n=0;for(let a=0;a<e.length;a++){let l=o?31-Math.clz32(e[a]||1):e[a],_=h>>(l<<2)&15;n|=_<<c,c+=i,c>=8&&(this.backend.writeUint8(n),c-=8,n>>=8)}c>0&&this.backend.writeUint8(n)}writeArrayLength(e){this.arrayLengths.push(e)}writeArrayHeader(e,r,o,h,s){let i=(h|(e&ve)<<1|o<<5|s<<9)<<16|r,c=this.arrayHeaders.get(i);c===void 0&&this.arrayHeaders.set(i,c=this.arrayHeaders.size),this.arrayHeaderRefs.push(c)}vlqBytesNeeded(e){let r=0;for(;e>se;)e/=268435456,r+=4;return et[Math.clz32(e)]+r}writeVlq(e){if(e<=Be)this.backend.writeUint8(e<<1|0);else if(e<=De)this.backend.writeUint16(e<<2|1);else if(e<=Pe)this.backend.writeUint24(e<<3|3);else{let r=e&se;this.backend.writeUint32((e>r?2147483648:0)+(r<<3|7)),e>r&&this.writeUintVar((e-r)/(1<<28))}}writeUintVar(e){if(e<=127)this.backend.writeUint8(e&127);else if(e<=16383)this.backend.writeUint16(e<<1&32512|128|e&127);else if(e<=2097151)this.backend.writeUint24(e<<2&8323072|32768|e<<1&32512|128|e&127);else{let r=this.vlqBytesNeeded(e);this.backend.ensureCapacity(r);for(let o=0;o<r-1;o++)this.backend.writeUint8(128|e&127),e=e>Q?(e-(e&127))/128:e>>>7;this.backend.writeUint8(e&127)}}intVarBytesNeeded(e){return this.vlqBytesNeeded(e<0?-2*e:2*e)}writeIntVar(e){let r=0;e<0&&(r=1,e=-e),e<=Ue?e=e<<1|r:e=2*e+r,this.writeUintVar(e)}writeNumber(e,r){switch(r){case y:this.backend.writeUint8(e);break;case U:this.backend.writeUint16(e);break;case H:this.backend.writeUint24(e);break;case K:this.backend.writeUint32(e);break;case z:this.writeUintVar(e);break;case B:this.backend.writeInt8(e);break;case D:this.backend.writeInt16(e);break;case P:this.backend.writeInt24(e);break;case L:this.backend.writeInt32(e);break;case G:this.writeIntVar(e);break;case W:this.backend.writeFloat32(e);break;case J:this.backend.writeFloat64(e);break;default:throw new Error("Unknown numeric type: "+r)}}};function Ee(t){return ce(t)||V}function ce(t){switch(typeof t){default:return X;case"boolean":return t?F:q;case"string":return Y;case"number":return Number.isFinite(t)?w:V;case"object":return t===null?V:Array.isArray(t)?g:b}}function fe(t,e){let r=0;for(let o=0;o<t.length;o++)t[o]===e&&r++;return r}var tt=new Map,dt=Object.freeze({hasInlinedEntries:!1,columns:tt}),xt=Object.freeze({hasInlinedEntries:!0,columns:tt});function rt(t,e,r){if(!(r&b))return dt;let o=r===b,h=o?t.length:fe(e,b);if(h>1){let s=new Map,f=!1;for(let i=0,c=0;i<t.length;i++)if(o||e[i]===b){let n=t[i];for(let a of Object.keys(n)){let l=n[a],_=ce(l);if(_===X)continue;let u=s.get(a);u===void 0&&s.set(a,u={key:a,typeBitmap:0,values:new Array(h),valueCount:0}),u.typeBitmap|=_,u.values[c]=l,u.valueCount++}c++}for(let i of s.values()){i.valueCount!==h&&(i.typeBitmap|=Le);let c=k[i.typeBitmap];if(c===1)continue;let n=32-Math.clz32(c-1),l=2+Math.ceil(n*h/8),_=i.valueCount*(1+!f);l>_&&(f=!0,s.delete(i.key))}if(s.size>0)return{hasInlinedEntries:f,columns:s}}return xt}var Tt=nt();function st(){Tt=nt()}function nt(){return new Proxy(Object.create(null),{get(t,e){return Object.hasOwn(t,e)?Reflect.get(...arguments):t[e]=0}})}var pt=Object.hasOwnProperty,At=new Map;function it(t){let e=ce(t);return e===X?0:(e===w?Te(t):0)<<3|31-Math.clz32(e)}function bt(t,e={}){function r(i,c=At){let n=0;for(let a in i)if(pt.call(i,a)&&!c.has(a)){let l=i[a],_=it(l);if(_===X)continue;s.writeObjectEntryKey(n,a,_),h(_,l),n++}s.writeObjectEntriesEnd(n)}function o(i,c=!1,n=0){if(i.length===0){s.writeArrayLength(0);return}let a=null,l=0,_=null;if(n===0)for(let N=0;N<i.length;N++)n|=Ee(i[N]);k[n]>1&&(a=i.map(Ee)),n&w&&(_=n===w?i:i.filter((N,x)=>a[x]===w),l=pe(s,_,!1));let{hasInlinedEntries:u,columns:I}=rt(i,a,n),d=I.size!==0,T=0;if(c||s.writeArrayLength(i.length),s.writeArrayHeader(n,l,d,u,T),k[n]>1&&s.writeTypeIndex(a,n,!0),n&Y)for(let N=0;N<i.length;N++)(a===null||a[N]===Y)&&s.writeString(i[N]);if(n&w&&Ae(s,_,l),T){let N=n===g?i:i.filter(Array.isArray);O(s,N.map(x=>x.length),!0),o(N.flat())}else if(n&g)for(let N=0;N<i.length;N++)(a===null||a[N]===g)&&o(i[N]);if(d){s.writeVlq(I.size);for(let N of I.keys())s.writeString(N);for(let N of I.values())o(N.values,!0,N.typeBitmap)}if(u)for(let N=0;N<i.length;N++)(a===null||a[N]===b)&&r(i[N],I)}function h(i,c){switch(1<<(i&7)){case Y:s.writeString(c);break;case w:s.writeNumber(c,i>>3);break;case b:r(c);break;case g:o(c);break}}let s=new oe(e.chunkSize),f=it(t);return st(),s.writeNumber(f,y),h(f,t),s.emit()}function ot(t,e,r,o=new Array(r)){let h=e&15,s=e&48,f=r,i=0,c=0;switch(s){case $:{i=o[0]=t.readIntVar(),f--,c=1;break}case ie:{i=t.readIntVar();break}}switch(h){case m:{for(let n=0;n<f;n++)o[c+n]=t.readVlq();break}case M:{for(let n=0;n<f;n++)o[c+n]=t.readIntVar();break}case C:{let n=t.readBytes(Math.ceil(f/2));for(let a=0,l=0;a<f;a++)l=a&1?l>>4:n[a>>1],o[c+a]=l&8?t.readVlq()*8+(l&7):l&7;break}case S:{let n=t.readBytes(Math.ceil(f/2));for(let a=0,l=0;a<f;a++){l=a&1?l>>4:n[a>>1];let _=l&4?-1:1;o[c+a]=l&8?_*(t.readVlq()*4+(l&3)):_*(l&3)}break}case j:{let n=e>>8,a=(1<<n)-1,l=t.readBytes(Math.ceil(f*n/8)),_=0,u=0,I=0;for(let d=0;d<f;d++){for(;u<n;)I|=l[_++]<<u,u+=8;o[c+d]=I&a,I>>=n,u-=n}break}case v:{let n=e>>8,a=(1<<n)-1,l=t.readBytes(Math.ceil(f*n/8)),_=0,u=0,I=0;for(let d=0;d<f;d++){for(;u<n;)I|=l[_++]<<u,u+=8;o[c+d]=I&1?-((I&a)>>1):(I&a)>>1,I>>=n,u-=n}break}case ne:{let n=o[0]=t.readIntVar(),a=t.readIntVar();for(let l=1;l<r;l++)o[l]=n+=a;break}case R:case E:{let n=h===E,a=e>>8,l=n?e&he|a&Z:a;if(k[a]>1){let u=t.readTypeIndex(f,l);for(let I=0;I<f;I++)o[c+I]=t.readNumber(u[I])}else{let u=31-Math.clz32(l);for(let I=0;I<f;I++)o[c+I]=t.readNumber(u)}break}default:throw new Error(`Unknown numeric array encoding method: ${h}`)}switch(s){case $:{o[0]=i;for(let n=1;n<r;n++)o[n]+=o[n-1];break}case ie:{for(let n=0;n<r;n++)o[n]+=i;break}}return o}var ae=12;function ct(t){return t===re||t===9}function Et(t){try{let{version:e}=we(t);if(ct(e))return!0;throw new Error(`Unsupported jsonxl version "${e}", expected "${re}"`)}catch{return!1}}function we(t){if(t.byteLength<ae)throw new Error(`Header length must be at least ${ae} bytes`);let e=new Uint8Array(t.buffer,t.byteOffset,ae);if(e.subarray(0,8).some((f,i)=>f!==le[i]))throw new Error("Bad magic number");let o=new DataView(e.buffer,e.byteOffset,ae),h=o.getUint16(8,!0),s=o.getUint16(10,!0);return{version:h,flags:s,headerSize:ae}}var wt=new TextDecoder("utf8",{ignoreBOM:!0});function gt(t){let e=wt.decode(t.readBytes(t.readVlq())),r=t.readNumericArray(),o=t.readNumericArray(),h=t.readNumericArray(),s=new Array(r);for(let f=0,i=0,c=0,n=0,a="";f<r.length;f++){let l=r[f],_=e.slice(i,i+=l>>2);l&2&&(_=a.slice(0,o[c++])+_),l&1&&(_=_+a.slice(-h[n++])),s[f]=_,a=_}return s}var _e=class{constructor(e,r){this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.bytes=e,this.pos=0,typeof r=="function"&&r(this),this.consumeHeader(),this.loadStrings(),this.loadArrayLengths(),this.loadArrayHeaders(),this.loadObjectEntries()}consumeHeader(){let{version:e,flags:r,headerSize:o}=we(this.view);return this.pos+=o,{version:e,flags:r}}loadStrings(){this.strings=gt(this),this.stringRefs=this.readNumericArray(),this.stringRefsCursor=0}loadArrayHeaders(){this.arrayHeaders=this.readNumericArray(),this.arrayHeaderRefs=this.readNumericArray(),this.arrayHeaderRefsCursor=0}loadArrayLengths(){this.arrayLengths=this.readNumericArray(),this.arrayLengthsCursor=0}loadObjectEntries(){let e=this.readVlq(),r=this.readVlq();this.objectEntries=new Array(e),this.objectKeys=r?this.stringRefs.slice(-r).map(o=>this.strings[o]):[];for(let o=0;o<e;o++)this.objectEntries[o]={dict:this.readNumericArray(),refs:this.readNumericArray(),cursor:0}}readString(){return this.strings[this.stringRefs[this.stringRefsCursor++]]}readArrayHeader(){return this.arrayHeaders[this.arrayHeaderRefs[this.arrayHeaderRefsCursor++]]}readArrayLength(){return this.arrayLengths[this.arrayLengthsCursor++]}readObjectEntry(e){let r=this.objectEntries[e],o=r.refs[r.cursor++],h=r.dict[o];return h===0?null:{key:this.objectKeys[h>>8],type:h&255}}readBytes(e){return this.bytes.subarray(this.pos,this.pos+=e)}readTypeIndex(e,r,o){let h=0,s=0,f=0;for(;r>0;)r&1&&(h|=f<<(s++<<2)),f++,r>>=1;let i=new Uint8Array(e),c=32-Math.clz32(s-1),n=(1<<c)-1,a=this.readBytes(Math.ceil(c*e/8)),l=0,_=0,u=0;for(let I=0;I<e;I++){u<c&&(_|=a[l++]<<u,u+=8);let d=h>>((_&n)<<2)&15;i[I]=o?1<<d:d,_>>=c,u-=c}return i}readVlq(){let e=this.view.getUint8(this.pos);if(!(e&1))e=e>>1,this.pos+=1;else if(!(e&2))e=this.view.getUint8(this.pos+1)<<6|e>>2,this.pos+=2;else if(!(e&4))e=this.view.getUint16(this.pos+1,!0)<<5|e>>3,this.pos+=3;else{let r=this.view.getUint32(this.pos,!0);e=r>>>3&se,this.pos+=4,r>>>31&&(e+=this.readUintVar()*(1<<28))}return e}readUintVar(){let e=this.view.getUint8(this.pos++),r=e&127,o=128;for(;e&128;)e=this.view.getUint8(this.pos++),r+=(e&127)*o,o*=128;return r}readIntVar(){let e=this.readUintVar();return e&1?-(e-1)/2:e<=Q?e>>>1:e/2}readUint8(){let e=this.view.getUint8(this.pos);return this.pos++,e}readInt8(){let e=this.view.getInt8(this.pos);return this.pos++,e}readUint16(){let e=this.view.getUint16(this.pos,!0);return this.pos+=2,e}readInt16(){let e=this.view.getInt16(this.pos,!0);return this.pos+=2,e}readUint24(){let e=this.view.getUint16(this.pos,!0)|this.view.getUint8(this.pos+2)<<16;return this.pos+=3,e}readInt24(){let e=this.view.getUint16(this.pos,!0),r=this.view.getUint8(this.pos+2),o=r&128?(r<<16|e)-16777216:r<<16|e;return this.pos+=3,o}readUint32(){let e=this.view.getUint32(this.pos,!0);return this.pos+=4,e}readInt32(){let e=this.view.getInt32(this.pos,!0);return this.pos+=4,e}readFloat32(){let e=this.view.getFloat32(this.pos,!0);return this.pos+=4,e}readFloat64(){let e=this.view.getFloat64(this.pos,!0);return this.pos+=8,e}readNumber(e){switch(e){case y:return this.readUint8();case U:return this.readUint16();case H:return this.readUint24();case K:return this.readUint32();case z:return this.readUintVar();case B:return this.readInt8();case D:return this.readInt16();case P:return this.readInt24();case L:return this.readInt32();case G:return this.readIntVar();case W:return this.readFloat32();case J:return this.readFloat64()}}readNumericArrayEncoding(){let e=this.readUint8();switch(e&15){case R:case E:case j:case v:e|=this.readUint8()<<8;break}return e}readNumericArray(e=this.readVlq()){if(e===0)return[];let r=this.readNumericArrayEncoding();return this.readNumbers(r,e)}readNumbers(e,r,o){return ot(this,e,r,o)}};function yt(t,e){function r(i={}){let c=0,n;for(;n=s.readObjectEntry(c++);)i[n.key]=h(n.type);return i}function o(i=s.readArrayLength()){if(i===0)return[];let c=s.readArrayHeader(),n=c>>16,a=c&65535,l=n&1,_=n>>5&1,u=n>>9&1,I=n>>1&255|(n&1)<<4,d=new Array(i),T=k[I]>1?s.readTypeIndex(i,I,!0):null;if(I&Xe)if(T===null)switch(I){case V:d.fill(null);break;case F:d.fill(!0);break;case q:d.fill(!1);break}else for(let N=0;N<i;N++)switch(T[N]){case V:d[N]=null;break;case F:d[N]=!0;break;case q:d[N]=!1;break}if(I&Y)for(let N=0;N<i;N++)(T===null||T[N]===Y)&&(d[N]=s.readString());if(I&w)if(I===w)s.readNumbers(a,i,d);else{let N=fe(T,w),x=s.readNumbers(a,N);for(let p=0,A=0;p<i;p++)T[p]===w&&(d[p]=x[A++])}if(I&g)if(u){let N=I===g?i:fe(T,g),x=s.readNumericArray(N),p=o();for(let A=0,Ne=0,ee=0;A<i;A++)(T===null||T[A]===g)&&(d[A]=p.slice(ee,ee+=x[Ne++]))}else for(let N=0;N<i;N++)(T===null||T[N]===g)&&(d[N]=o());if(I&b){let N=I===b?d:[];for(let x=0,p=0;x<i;x++)(T===null||T[x]===b)&&(d[x]=N[p++]={});if(_){let x=s.readVlq(),p=new Array(x);for(let A=0;A<x;A++)p[A]=s.readString();for(let A=0;A<x;A++){let Ne=p[A],ee=o(N.length);for(let te=0;te<N.length;te++)ee[te]!==void 0&&(N[te][Ne]=ee[te])}}if(l)for(let x=0;x<N.length;x++)r(N[x])}return d}function h(i){switch(1<<(i&7)){case V:return null;case Y:return s.readString();case w:return s.readNumber(i>>3);case b:return r();case F:return!0;case q:return!1;case g:return o()}}let s=new _e(t,e),f=h(s.readUint8());if(s.pos!==t.byteLength)throw new Error("End of input is not reached");return f}export{oe as Writer,be as createWriterBackend,yt as decode,bt as encode,Et as isHeaderAcceptable,ct as isVersionSupported,we as parseHeader};
//# sourceMappingURL=jsonxl.min.js.map
